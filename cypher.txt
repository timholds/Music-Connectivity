CREATE CONSTRAINT ON (a:album) ASSERT a.albumName IS UNIQUE;
CREATE CONSTRAINT ON (s:song) ASSERT s.songName IS UNIQUE;
CREATE CONSTRAINT ON (a:artist) ASSERT a.artistName IS UNIQUE;
CREATE CONSTRAINT ON (f:feature) ASSERT f.artistName IS UNIQUE;

### Second edition - works better than first edition as no duplicate artist nodes

USING PERIODIC COMMIT
        LOAD CSV WITH HEADERS from 'https://s3-us-west-1.amazonaws.com/tim-test000/artist-test.csv' as line

        MERGE (album:Album {albumName: line.Album, albumYear: line.Year})
        MERGE (artist:Artist {artistName: line.Artist})
        MERGE (song:Song {songName: line.Song})

        MERGE (artist)-[:CREATED]->(album)
        CREATE (album)-[:HAS_SONG]->(song)

        WITH line
        WHERE NOT line.Feature1 IS NULL
        MERGE (feature:Artist {artistName: line.Feature1})

        MERGE (song:Song {songName: line.Song})-[:FEATURES]->(feature)


